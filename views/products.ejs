<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles/basic.css">
    <link rel="stylesheet" href="/styles/productsPage.css">
    <title>Frutti</title>
    <link rel="icon" href="/strawberry.png" type="image/png">
</head>

<body>
    <nav class="navigation">
        
        <div class="middle-nav">
            <input class="middle-input" type="text" placeholder="Search">
        </div>
        <div class="right-nav">
            <div class="products"><a href="/products">Products</a></div>
            <div class="categories"><a href="/categories">Categories</a></div>
        </div>

    </nav>
    <main>
        <!-- Adding product form-->
        <div class="form-container">
            <form action="/products" method="POST" enctype="multipart/form-data" class="form-add from-add-js">
                <label for="image">Select image:</label>
                <input type="file" name="image" id="image" accept="image/*" required>
                <label for="name">Product name:</label>
                <input type="text" id="name" name="name" required>
                <!-- keep current filters so they persist after submitting this form -->
                <input type="hidden" name="sort" value="<%= typeof sort !== 'undefined' ? sort : '' %>">
                <input type="hidden" name="category" value="<%= typeof category !== 'undefined' ? category : '' %>">
                <div class="select-container">
                    <label for="category">Category:</label>
                    <select id="category" name="category" required>
                        <% if(productsCategory !=='undefined' && productsCategory.length> 0 ){
                            productsCategory.forEach(category => {
                            %> <option value="<%= category %>">
                                <%= category %>
                            </option>
                            <% }) } %>
                    </select>
                </div>
                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" name="quantity">
                <label for="price">Price:</label>
                <input type="number" id="price" name="price" step="0.01" min="0" required>
                <button type="submit" class="submit">Submit</button>
            </form>
        </div>



        <!-- FILTERS, NAV WITH CATEGORIES-->
        <div class="filters">
            <form method="GET" action="/products">
                <button class="submit submit-apply" type="submit">Apply filters</button>
                <div class="price-filters">
                    <label class="sort-label">Sort by price:</label>
                    <div class="div-asc">
                        <label class="label-asc" for="asc">Ascending </label>
                        <input type="radio" id="asc" name="sort" value="asc" <% if(typeof sort !=='undefined' &&
                            sort==='asc' ) { %> checked <% } %>>
                    </div>
                    <div class="div-desc">
                        <label class="label-desc" for="desc">Descending</label>
                        <input type="radio" id="desc" name="sort" value="desc" <% if(typeof sort !=='undefined' &&
                            sort==='desc' ) { %> checked <% } %>>
                    </div>
                </div>
                <% if(productsCategory.length> 0) { productsCategory.forEach(cat => {
                    %>
                    <div class="category-row">
                        <label for="<%=cat %>">
                            <%= cat %>
                        </label>
                        <input type="radio" id="<%=cat %>" name="category" value="<%=cat %>" <% if(typeof category
                            !=='undefined' && category===cat) { %> checked <% } %>>
                    </div>
                    <% }) } %>
                        <div class="category-row">
                            <label for="all">All</label>
                            <input type="radio" id="all" name="category" value="all" <% if(typeof category
                                !=='undefined' && category==='all' ) { %> checked <% } %>>
                        </div>
            </form>
        </div>

        <!-- All products container, grid of products-->
        <div class="food-products-container">
            <% if(products && products.length> 0) { products.forEach(product=> {
                if(product.product_name) {
                %>
                <div class="single-food-product">
                    <img src="/<%=product.image_url %>" alt="food image" class="product-image">
                    <div class="product-name">
                        <%= product.product_name %>
                    </div>
                    <div class="product-category">
                        <%= product.category_name %>
                    </div>
                    <div class="product-quantity">Quantity: <%= product.quantity %>
                    </div>
                    <div class="product-price">Price: $<%= product.price %>
                    </div>
                    <!-- Deleting/updating form -->
                    <div class="delete-container">
                        <form class="form-add form-delete-js" action="/products/delete" method="post">
                            <label for="amount">Delete amount of products:</label>
                            <div class="opak-delete">
                                <input type="number" min="-1" id="amount" name="amount" placeholder="0" required>
                                <input type="hidden" name="productId" value="<%= product.id %>">
                                <!-- preserve current filters so they remain selected after delete -->
                                <input type="hidden" name="sort" value="<%= typeof sort !== 'undefined' ? sort : '' %>">
                                <input type="hidden" name="category"
                                    value="<%= typeof category !== 'undefined' ? category : '' %>">
                                <button type="submit">
                                    <img class="delete-small-image" src="/delete.png" alt="">
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="trash-container"><img class="trash-image" src="/delete.png"></div>
                </div>

                <% }})} %>
                    <div class="single-food-product"><button class="add-product add-js">Add product +</button></div>
        </div>
    </main>

    <footer>&copy; 2025 hubfrt1337 | The Odin Project </footer>


    <script src="/product.js"></script>
</body>

</html>